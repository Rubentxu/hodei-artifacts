use async_trait::async_trait;
use crate::domain::vulnerability::VulnerabilityReport;

// Puerto para obtener un informe de vulnerabilidades.
#[async_trait]
pub trait IVulnerabilityReportRepository: Send + Sync {
    async fn get_report_by_artifact_id(&self, artifact_id: &str) -> Result<Option<VulnerabilityReport>, RepositoryError>;
    async fn get_report_by_id(&self, report_id: &str) -> Result<Option<VulnerabilityReport>, RepositoryError>;
}

// Errores espec√≠ficos de los puertos
#[derive(Debug, thiserror::Error)]
pub enum RepositoryError {
    #[error("Failed to get report: {0}")]
    GetError(String),
}