# Story 1.10: Detecci√≥n de Content-Type

## Status

Draft

## Story

**As a** System,
**I want** to automatically and accurately detect the MIME type of an uploaded artifact, even if the client provides an incorrect `Content-Type` header,
**so that** artifacts are stored with the correct MIME type, enabling proper handling by browsers and other tools.

## Acceptance Criteria

1. The system must inspect the file's magic numbers (the first few bytes of the file) to determine its true MIME type.
2. This detection should happen server-side after the upload begins.
3. The detected MIME type should be stored in the artifact's metadata.
4. The system should use a reliable library (e.g., `infer`) for this purpose.
5. If the client-provided `Content-Type` header mismatches the detected type, the detected type should take precedence, and a warning may be logged.
6. The detection should be performant and not significantly impact upload times.

## Tasks / Subtasks

- [ ] Integrate a magic number detection library (e.g., `infer`).
- [ ] Add a step in the upload workflow to perform the detection.
- [ ] Store the detected MIME type in the `ArtifactMetadata`.
- [ ] Implement logging for `Content-Type` mismatches.
- [ ] Write unit tests with various file types to verify detection accuracy.

## Dev Notes

### Technical Constraints
- The detection library should support a wide range of common artifact types (JAR, ZIP, GZ, PNG, etc.).
- The process must be efficient, only requiring a small initial chunk of the file.